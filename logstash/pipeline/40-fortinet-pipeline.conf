input {
  pipeline {
    address => "fortinet-pipeline"
  }
}

filter {
  mutate {
    # HATA 1 DÜZELTMESİ: Doğru metadata alanı kullanıldı
    add_field => { "[@metadata][target_index]" => "fortinet-firewall-logs" }
  }
  
  # Firewall saldırı tespiti
  if [fortinet][firewall][action] == "deny" or 
     [fortinet][firewall][action] == "blocked" {
    mutate {
      add_tag => ["firewall_blocked"]
    }
  }
}

output {
  pipeline {
    # HATA 2 DÜZELTMESİ: Doğru çıkış kanalı kullanıldı
    send_to => ["es_output_channel"]
  }
}